function myPopup(url,windowname,w,h,x,y){window.open(url,windowname,"resizable=no, toolbar=no, scrollbars=no, menubar=no, status=no, directories=no, width="+w+", height="+h+", left="+x+", top="+y);}
if(!rates){var rates=[];}
function cUTCToLocal(date){var newDate=new Date(date.getTime()+date.getTimezoneOffset()*60*1000);var offset=date.getTimezoneOffset()/60;var hours=date.getHours();newDate.setHours(hours-offset);return newDate;}
(function($){changeDate=function(date,url){if(!url)url='/index.php?option=com_currencies&task=getrate&format=ajax&date=';$.ajax({url:url+date,type:'POST',dataType:'json',data:JSON.stringify({'date':date}),success:function(data){if(data['success']){$("#date").val(data['success']['date']);$(".select.date .selected-item,.select.date .select-options").attr('data-value',data['success']['date']);$(".select.date .selected-item").text(data['success']['date']);$('.datepicker').datepicker("setDate",cUTCToLocal(new Date(data['success']['date'])));$('.mconv-date span').text(data['success']['date']);$("#rate_date").val(data['success']['date']);rates=data['success']['rates'];reconvert();}else{$('.datepicker').datepicker("setDate",cUTCToLocal(new Date($('.mconv-date span').text())));alert('No data!');}},error:function(){}});}
reconvert=function(){$('.exchage-results.show').removeClass('show');$('#multiconvert .exchange-to-blocks select').each(function(){if($(this).val()!=0){$(this).trigger('input');}});};function noExponent(n){var data=String(n).split(/[eE]/);if(data.length==1)return data[0];var z='',sign=+n<0?'-':'',str=data[0].replace('.',''),mag=Number(data[1])+1;if(mag<0){z=sign+'0.';while(mag++)z+='0';return z+str.replace(/^\-/,'');}
mag-=str.length;while(mag--)z+='0';return str+z;}
$(document).ready(function(){$('.convert-page .curse .result, .convert-page .color-table td').each(function(){textArr=$(this).text().split(' ');for(var i=textArr.length-1;i>=0;i--){if(textArr[i].match(/([0-9]*\.[0-9]*)([eE])([-])?([0-9])/g)){numArr=noExponent(textArr[i])
textArr[i]=noExponent(textArr[i]);console.log(textArr[i]);}}
$(this).text(textArr.join(' '));});;var date=($('#date').length>0)?$('#date').val():'';$('.datepicker').each(function(){var datepicker=$(this);datepicker.datepicker({dateFormat:'yy-mm-dd',dayNamesMin:['S','M','T','W','T','F','S'],maxDate:(datepicker.attr('data-maxdate'))?cUTCToLocal(new Date(datepicker.attr('data-maxdate'))):cUTCToLocal(new Date()),onSelect:function(dateText,inst){changeDate(dateText);closeSelect();},onChangeMonthYear:function(){$(this).parents('.select.active').addClass('month-changed');}}).datepicker("setDate",cUTCToLocal(new Date(datepicker.attr('data-value'))));});$('.item>.img-intro>img').on('click',function(){var links=$(this).parents('.item').find('a.readmore, .item-title>a');if(links.length>0)links[0].click();});var openSelect=0;$('#main').prepend($('#article-image'));if($('.currency-list-page')[0]){$('#main>.center-wrap').prepend($('#system-message-container, #content'));}
$('#article-image').addClass('center-wrap');$('.selected-item').each(function(){if($(this).siblings('select').length>0){$(this).html('<span>'+$(this).text()+'</span><input class="filter-input" value="" />');}});$('.selected-item').on('click',function(e){if($(this).parent().is('.select')){var select=$(this).parent();if(!select.hasClass('active')){if(openSelect){closeSelect();}
$('.filter-input',select).focus();select.toggleClass('active');openSelect=1;}else{if(!$(e.target).hasClass('filter-input'))closeSelect();}}});$('.select-options').mCustomScrollbar({axis:"y",scrollButtons:{enable:true,scrollType:"stepless"},scrollInertia:1,callbacks:{whileScrolling:function(){var evt=window.document.createEvent('UIEvents');evt.initUIEvent('resize',true,false,window,0);window.dispatchEvent(evt);}}});$('.select-block .convert-icon').on('click',function(){var selects=$(this).siblings();var to=$('.from select[name="from"]',selects).val();var from=$('.to select',selects).val();var span='';$('.to select',selects).val(to);$('.from select',selects).val(from);$('selected',selects).removeClass('selected');var itext=$('.from [data-value='+from+']',selects).addClass('selected').text();if($('.from .selected-item',selects).find('span').length>0){$('.from .selected-item',selects).attr('data-value',from).find('span').text(itext);}else{$('.from .selected-item',selects).attr('data-value',from).text(itext);}
itext=$('.to [data-value='+to+']',selects).addClass('selected').text();if($('.to .selected-item',selects).find('span').length>0){$('.to .selected-item',selects).attr('data-value',to).find('span').text(itext);}else{$('.to .selected-item',selects).attr('data-value',to).text(itext);}});$('.select-option').on('click',function(){if(!$(this).hasClass('selected')){$(this).siblings('.selected').removeClass('selected');$(this).addClass('selected');var parent=$(this).parents('.select.active');var selected=$('.selected-item',parent);selected.attr('data-value',$(this).attr('data-value'));if(selected.find('span')){$('span',selected).text($(this).text());}else{selected.text($(this).text());}
$('select',parent).val($(this).attr('data-value'));$('select',parent).trigger('change');}
closeSelect();})
$('.site-header>div:not(#menu)>.block-title').on('click',function(){if($(this).parent().hasClass('active')){$(this).siblings('.block-body').fadeOut('400',function(){$(this).parent().removeClass('active');});}else{$('.site-header>div.active>.block-body').fadeOut('fast',function(){$(this).parent().removeClass('active');});$(this).siblings('.block-body').fadeIn("400",function(){$(this).parent().addClass('active');});}});var didScroll;var lastScrollTop=0;var delta=5;var navbarHeight=$('.site-header').outerHeight();setInterval(function(){if(didScroll){hasScrolled();didScroll=false;}},250);function hasScrolled(){var st=$(window).scrollTop();if(Math.abs(lastScrollTop-st)<=delta)
return;if(st>lastScrollTop&&st>navbarHeight){$('.site-header').removeClass('nav-down').addClass('nav-up');$('.site-header>div.active').removeClass('active');closeFullmenu();}else{if(st+$(window).height()<$(document).height()){$('.site-header').removeClass('nav-up').addClass('nav-down');}}
lastScrollTop=st;}
$(window).scroll(function(){if(!$("#fullmenu").hasClass('active')){didScroll=true;$('.site-header>div.active>.block-body').fadeOut('fast',function(){$(this).parent().removeClass('active');});var winSct=$(window).scrollTop();}});$('#fullmenu a[href="#"]').click(function(event){event.preventDefault();});$("#fullmenu .deeper >*:not(ul)").on("click",function(){var submenu=$(this).siblings('ul');if(submenu.hasClass("block")){submenu.removeClass("block");submenu.stop(true).slideUp(200);submenu.children("li").css("opacity",0);}
else{submenu.addClass("block");submenu.stop(true).slideDown(200);submenu.children("li").each(function(index){$(this).delay(index*100).animate({"opacity":1},200);});}});$(document).on('keyup',function(evt){if(evt.keyCode==27){closeFullmenu();closeSelect();}});function closeFullmenu(){$("html").css("overflow",'visible');$("body").css("overflow",'auto');$("#fullmenu ul li").css("opacity",0);$("#fullmenu ul.block").css("display","none");$("#fullmenu ul.block").removeClass("block");$("#fullmenu").removeClass('active');$("#fullmenu .menu-modules").scrollTop(0);}
$('.filter-input').on('input',function(){var select=$(this).parents('.select');var options=$('.select-option',select);var filter=$(this).val().toLowerCase();options.each(function(){if($(this).text().toLowerCase().indexOf(filter)>=0){$(this).removeClass('hide');}else{$(this).addClass('hide');}})});$('.filter-input').on('keydown',function(){if(event.which==13){$('.select-option:not(.hide)',$(this).parents('.select')).click();return false;}});function closeSelect(){openSelect=0;$('.select.active .select-option').removeClass('hide');$('.select.active .filter-input').val('');$('.select.active').removeClass('active month-changed');}
$(document).on('click',function(e){if(openSelect==1){var container=$('.select.active');if(container.hasClass('month-changed')&&($(e.target).hasClass('ui-datepicker-next')||$(e.target).hasClass('ui-datepicker-prev'))){container.removeClass('month-changed');}else if(!container.has(e.target).length){closeSelect();}}})
$("#fullmenu .close-btn").on('click',function(){closeFullmenu();});$("#menu .menu-btn").on('click',function(){var hOff=$(window).scrollTop();$('.site-header>div.active').removeClass('active');$("#fullmenu").addClass('active');$("html").css("overflow",'hidden');$("body").css("overflow",'hidden');$("#fullmenu ul.menu > li").each(function(index){$(this).stop(true).delay(index*150).animate({"opacity":1},200);});});$('.site-footer .subscribe input').on('change',function(){$(this).parents('.subscribe').removeClass('error1');$(this).parents('.subscribe').removeClass('error2');$(this).parents('.subscribe').removeClass('success');});$('.site-footer .subscribe:not(.success) button').on('click',function(){var email=$(this).siblings('input[name=email]').val();$.ajax({url:$(this).attr('data-form'),type:'POST',dataType:'json',data:JSON.stringify({'email':email}),success:function(data){var cl='';if(data["success"]){cl='success';}
if(data["error"]){cl='error'+data['error'];}
$('.site-footer .subscribe').addClass(cl);},error:function(){}});});var bLazy=new Blazy({});$('[data-flag], .b-lazy').each(function(){});$('form[name=chartsform]').on('submit',function(){var form=$(this);var query=form.attr('action')+'/'+$('[name=from]',form).val()+'-'+$('[name=to]',form).val();if($('[name=period]',form).val()!='week')query+='-by-'+$('[name=period]',form).val();window.location.href=query.toLowerCase();return false;});$('#multiconvert .exchange-from-block select').on('change input',function(){reconvert();});$('#multiconvert .exchange-to-blocks select').on('change input',function(){var to=$(this).val();var from=$('#multiconvert select[name=from]').val();var rate=0;if(rates[from]&&rates[to]){var rate=Math.round((rates[to]['crate'])/(rates[from]['crate'])*10000)/10000;console.log(rate);}
$(this).parent().siblings('input').val(rate);});$('#multiconvert').on('submit',function(e){e.preventDefault();var from=$('#multiconvert select.from').val();var amount=1*($('#multiconvert input.amount').val());var results='';var txt='';var csv='';$('#multiconvert .exchange-to-block').each(function(){var to=$('select option:selected',this).val();if(to&&to!=0){var rate=$('input',this).val();results+='<p>'+amount+' '+from+' = '+rate*amount+' '+to+' (Rate: 1 '+from+' = '+rate+' '+to+')</p>';txt+=amount+' '+from+' = '+rate*amount+' '+to+' (Rate: 1 '+from+' = '+rate+' '+to+')\\r\\n';csv+='\"'+amount+'\",\"'+from+'\",\"'+rate*amount+'\",\"'+to+'\",\"'+rate+'\"\\r\\n';}});if(results.length>0){$('#export_txt').attr('href','data:text/plain;charset=utf-8,'+encodeURIComponent(txt)).attr('download','export_'+$('.multiconverter-page .mconv-date span').text()+'.txt');$('#export_csv').attr('href','data:application/csv;charset=utf-8,'+encodeURIComponent(csv)).attr('download','export_'+$('.multiconverter-page .mconv-date span').text()+'.csv');$('.multiconverter-page .exchage-results .results').html(results).parent().addClass('show');}});$('#multiconvert .reset').on('click',function(){$('#multiconvert .exchange-to-blocks select,#multiconvert .amount').val(0);$('#multiconvert .exchange-to-blocks input').val('');$('#multiconvert .exchange-to-blocks .selected').removeClass('selected');if($('#multiconvert .exchange-to-blocks .selected-item>span').length>0){$('#multiconvert .exchange-to-blocks .selected-item>span').text('').parent().attr('data-value','');}else{$('#multiconvert .exchange-to-blocks .selected-item').text('').attr('data-value','');$('.multiconverter-page .exchage-results').removeClass('show').find('p').remove();}
changeDate();return false;});$('#multiconvert input, #multiconvert select').on('change input',function(){$('.multiconverter-page .exchage-results').removeClass('show').find('p').remove();});$('.sidebar-b').each(function(){var right=$(this);var modules=right.children('.moduletable');var count=modules.length;right.append('<div class="mods-header"></div>');var theader=right.children('.mods-header');var h=0;for(i=0;i<count;i++){theader.append('<a href="#" data-mod="'+i+'">&nbsp;</a>');modules.eq(i).attr('data-mod',i).attr('data-height',modules.eq(i).height()).css({'position':'absolute'});}
theader.children('a').on('click',function(){if(!$(this).hasClass('active')){$('.active[data-mod]',right).removeClass('active');h=$('[data-mod='+$(this).attr('data-mod')+']',right).addClass('active').attr('data-height');right.css({'height':h+'px'});}
return false;}).eq(0).click();});$('#lang li>span').eq(0).parent().addClass('active');$('#lang a').on('click',function(){if($(this).parent().hasClass('lang-change')){path=window.location.pathname;pathArr=path.split('/');href=$(this).attr('href');hrefArr=href.split('/');pathArr[1]=hrefArr[1];href=window.location.protocol+'//'+window.location.hostname+pathArr.join('/');window.location.href=href;return false;}else{href=$(this).attr('href')+window.location.pathname;window.location.href=href;return false;}});});})(jQuery);